"use strict";(self["webpackChunkdsk_ms_client"]=self["webpackChunkdsk_ms_client"]||[]).push([[601],{1601:function(e,o,n){n.r(o),n.d(o,{default:function(){return u}});n(7658);var t=function(){var e=this,o=e._self._c;return o("div",[o("div",{staticStyle:{height:"260px",border:"1px solid #666"},attrs:{id:"main"}}),o("el-divider",{attrs:{"content-position":"left"}},[e._v("书店列表")]),o("el-table",{attrs:{data:e.bookstores}},[o("el-table-column",{attrs:{prop:"bookstore_name",width:"150px",label:"书店名称"}}),o("el-table-column",{attrs:{prop:"address",label:"书店地址",align:"center"}}),o("el-table-column",{attrs:{width:"250px",label:"书店位置",align:"center"},scopedSlots:e._u([{key:"default",fn:function(o){return[e._v(" "+e._s(o.row.province)+" "+e._s(o.row.city)+" "+e._s(o.row.district)+" ")]}}])}),o("el-table-column",{attrs:{width:"180px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[o("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-map-location",circle:""},on:{click:function(o){return e.moveTo(n.row)}}}),o("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-edit",circle:""},on:{click:function(o){return e.$router.push("/home/bookstore-update/"+n.row.id)}}}),o("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(o){return e.del(n.row.id)}}})]}}])})],1)],1)},a=[],i=n(7634),s=n.n(i),l=n(3479),r={data(){return{bookstores:[],AMap:null}},methods:{moveTo(e){console.log(e);let o=e.longitude,n=e.latitude;this.map.setZoomAndCenter(15,[o,n],!1,700)},del(e){console.log("点击了删除",e),this.$confirm("此操作将永久删除该书店, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{l.Z.bookstoreApi.del({id:e}).then((e=>{console.log("删除成功了,删除的结果如下",e),200==e.data.code&&(this.initData(),this.$message({type:"success",message:"删除成功!"}))}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},initMap(){s().load({key:"7bc653e04678082d08022d65625bad6e",version:"2.0",plugins:["AMap.Geocoder"]}).then((e=>{this.AMap=e,this.map=new e.Map("main",{viewMode:"3D",zoom:12,center:[113.659404,34.772296]}),this.map.on("click",(o=>{let n=o.lnglat.getLng(),t=o.lnglat.getLat();console.log(`经纬度：[${n}, ${t}]`);let a=new e.Geocoder;a.getAddress([n,t],((e,o)=>{console.log(e,o);let a=o.regeocode.addressComponent;this.form.address=o.regeocode.formattedAddress,this.form.city=a.city,this.form.province=a.province,this.form.district=a.district,this.form.latitude=t,this.form.longitude=n}))})),this.initData()}))},initData(){l.Z.bookstoreApi.queryAll().then((e=>{console.log("加载书店列表",e),this.bookstores=e.data.data,this.bookstores.forEach((e=>{let o=e.longitude,n=e.latitude;var t=new AMap.Marker({position:new AMap.LngLat(o,n),title:e.bookstore_name});this.map.add(t)}))}))}},mounted(){this.initMap()}},c=r,p=n(1001),d=(0,p.Z)(c,t,a,!1,null,"cda4bb5a",null),u=d.exports},7634:function(e,o,n){n(7658),function(o,n){e.exports=n()}(0,(function(){function e(e){var t=[];return e.AMapUI&&t.push(o(e.AMapUI)),e.Loca&&t.push(n(e.Loca)),Promise.all(t)}function o(e){return new Promise((function(o,n){var l=[];if(e.plugins)for(var r=0;r<e.plugins.length;r+=1)-1==a.AMapUI.plugins.indexOf(e.plugins[r])&&l.push(e.plugins[r]);if(i.AMapUI===t.failed)n("前次请求 AMapUI 失败");else if(i.AMapUI===t.notload){i.AMapUI=t.loading,a.AMapUI.version=e.version||a.AMapUI.version,r=a.AMapUI.version;var c=document.body||document.head,p=document.createElement("script");p.type="text/javascript",p.src="https://webapi.amap.com/ui/"+r+"/main.js",p.onerror=function(e){i.AMapUI=t.failed,n("请求 AMapUI 失败")},p.onload=function(){if(i.AMapUI=t.loaded,l.length)window.AMapUI.loadUI(l,(function(){for(var e=0,n=l.length;e<n;e++){var t=l[e].split("/").slice(-1)[0];window.AMapUI[t]=arguments[e]}for(o();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()}));else for(o();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()},c.appendChild(p)}else i.AMapUI===t.loaded?e.version&&e.version!==a.AMapUI.version?n("不允许多个版本 AMapUI 混用"):l.length?window.AMapUI.loadUI(l,(function(){for(var e=0,n=l.length;e<n;e++){var t=l[e].split("/").slice(-1)[0];window.AMapUI[t]=arguments[e]}o()})):o():e.version&&e.version!==a.AMapUI.version?n("不允许多个版本 AMapUI 混用"):s.AMapUI.push((function(e){e?n(e):l.length?window.AMapUI.loadUI(l,(function(){for(var e=0,n=l.length;e<n;e++){var t=l[e].split("/").slice(-1)[0];window.AMapUI[t]=arguments[e]}o()})):o()}))}))}function n(e){return new Promise((function(o,n){if(i.Loca===t.failed)n("前次请求 Loca 失败");else if(i.Loca===t.notload){i.Loca=t.loading,a.Loca.version=e.version||a.Loca.version;var l=a.Loca.version,r=a.AMap.version.startsWith("2"),c=l.startsWith("2");if(r&&!c||!r&&c)n("JSAPI 与 Loca 版本不对应！！");else{r=a.key,c=document.body||document.head;var p=document.createElement("script");p.type="text/javascript",p.src="https://webapi.amap.com/loca?v="+l+"&key="+r,p.onerror=function(e){i.Loca=t.failed,n("请求 AMapUI 失败")},p.onload=function(){for(i.Loca=t.loaded,o();s.Loca.length;)s.Loca.splice(0,1)[0]()},c.appendChild(p)}}else i.Loca===t.loaded?e.version&&e.version!==a.Loca.version?n("不允许多个版本 Loca 混用"):o():e.version&&e.version!==a.Loca.version?n("不允许多个版本 Loca 混用"):s.Loca.push((function(e){e?n(e):n()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var t;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(t||(t={}));var a={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:t.notload,AMapUI:t.notload,Loca:t.notload},s={AMap:[],AMapUI:[],Loca:[]},l=[],r=function(e){"function"==typeof e&&(i.AMap===t.loaded?e(window.AMap):l.push(e))};return{load:function(o){return new Promise((function(n,s){if(i.AMap==t.failed)s("");else if(i.AMap==t.notload){var c=o.key,p=o.version,d=o.plugins;c?(window.AMap&&"lbs.amap.com"!==location.host&&s("禁止多种API加载方式混用"),a.key=c,a.AMap.version=p||a.AMap.version,a.AMap.plugins=d||a.AMap.plugins,i.AMap=t.loading,p=document.body||document.head,window.___onAPILoaded=function(a){if(delete window.___onAPILoaded,a)i.AMap=t.failed,s(a);else for(i.AMap=t.loaded,e(o).then((function(){n(window.AMap)}))["catch"](s);l.length;)l.splice(0,1)[0]()},d=document.createElement("script"),d.type="text/javascript",d.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+a.AMap.version+"&key="+c+"&plugin="+a.AMap.plugins.join(","),d.onerror=function(e){i.AMap=t.failed,s(e)},p.appendChild(d)):s("请填写key")}else if(i.AMap==t.loaded)if(o.key&&o.key!==a.key)s("多个不一致的 key");else if(o.version&&o.version!==a.AMap.version)s("不允许多个版本 JSAPI 混用");else{if(c=[],o.plugins)for(p=0;p<o.plugins.length;p+=1)-1==a.AMap.plugins.indexOf(o.plugins[p])&&c.push(o.plugins[p]);c.length?window.AMap.plugin(c,(function(){e(o).then((function(){n(window.AMap)}))["catch"](s)})):e(o).then((function(){n(window.AMap)}))["catch"](s)}else if(o.key&&o.key!==a.key)s("多个不一致的 key");else if(o.version&&o.version!==a.AMap.version)s("不允许多个版本 JSAPI 混用");else{var u=[];if(o.plugins)for(p=0;p<o.plugins.length;p+=1)-1==a.AMap.plugins.indexOf(o.plugins[p])&&u.push(o.plugins[p]);r((function(){u.length?window.AMap.plugin(u,(function(){e(o).then((function(){n(window.AMap)}))["catch"](s)})):e(o).then((function(){n(window.AMap)}))["catch"](s)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,a={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:t.notload,AMapUI:t.notload,Loca:t.notload},s={AMap:[],AMapUI:[],Loca:[]}}}}))}}]);
//# sourceMappingURL=601.411d6c4c.js.map
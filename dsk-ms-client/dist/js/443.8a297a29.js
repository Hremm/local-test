"use strict";(self["webpackChunkdsk_ms_client"]=self["webpackChunkdsk_ms_client"]||[]).push([[443],{5443:function(e,o,t){t.r(o),t.d(o,{default:function(){return u}});var i=function(){var e=this,o=e._self._c;return o("div",[o("el-form",{ref:"form",staticStyle:{width:"650px"},attrs:{"label-width":"120px",rules:e.rules,model:e.form}},[o("el-form-item",{attrs:{label:"书店名称",prop:"bookstore_name"}},[o("el-input",{attrs:{type:"text"},model:{value:e.form.bookstore_name,callback:function(o){e.$set(e.form,"bookstore_name",o)},expression:"form.bookstore_name"}})],1),o("el-form-item",{attrs:{label:"选择位置"}},[o("div",{staticStyle:{height:"200px",border:"1px solid #666"},attrs:{id:"container"}})]),o("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[o("el-input",{attrs:{type:"text"},model:{value:e.form.address,callback:function(o){e.$set(e.form,"address",o)},expression:"form.address"}})],1),o("el-form-item",{attrs:{label:"省份",prop:"province"}},[o("el-input",{attrs:{type:"text"},model:{value:e.form.province,callback:function(o){e.$set(e.form,"province",o)},expression:"form.province"}})],1),o("el-form-item",{attrs:{label:"城市",prop:"city"}},[o("el-input",{attrs:{type:"text"},model:{value:e.form.city,callback:function(o){e.$set(e.form,"city",o)},expression:"form.city"}})],1),o("el-form-item",{attrs:{label:"地区",prop:"district"}},[o("el-input",{attrs:{type:"text"},model:{value:e.form.district,callback:function(o){e.$set(e.form,"district",o)},expression:"form.district"}})],1),o("el-form-item",{attrs:{label:"经度",prop:"longitude"}},[o("el-input",{attrs:{type:"text"},model:{value:e.form.longitude,callback:function(o){e.$set(e.form,"longitude",o)},expression:"form.longitude"}})],1),o("el-form-item",{attrs:{label:"纬度",prop:"latitude"}},[o("el-input",{attrs:{type:"text"},model:{value:e.form.latitude,callback:function(o){e.$set(e.form,"latitude",o)},expression:"form.latitude"}})],1),o("el-form-item",{attrs:{label:"选择类型",prop:"types"}},[o("el-select",{attrs:{multiple:""},model:{value:e.form.types,callback:function(o){e.$set(e.form,"types",o)},expression:"form.types"}},e._l(e.types,(function(e){return o("el-option",{key:e.id,attrs:{label:e.typename,value:e.typename}})})),1)],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("新增书店")]),o("el-button",{on:{click:function(o){return e.cancelExpert("form")}}},[e._v("重置")])],1)],1)],1)},n=[],a=(t(7658),t(7634)),r=t.n(a),s=t(3479),l={data(){return{types:[],form:{id:this.$route.params.id,bookstore_name:"",address:"",province:"",city:"",district:"",longitude:"",latitude:"",types:[]},rules:{bookstore_name:[{required:!0,message:"该字段不能为空",trigger:"blur"}],address:[{required:!0,message:"该字段不能为空",trigger:"blur"}],province:[{required:!0,message:"该字段不能为空",trigger:"blur"}],city:[{required:!0,message:"该字段不能为空",trigger:"blur"}],district:[{required:!0,message:"该字段不能为空",trigger:"blur"}],longitude:[{required:!0,message:"该字段不能为空",trigger:"blur"}],latitude:[{required:!0,message:"该字段不能为空",trigger:"blur"}],types:[{required:!0,message:"该字段不能为空",trigger:"change"}]}}},methods:{cancelExpert(e){this.$refs[e].resetFields()},submit(){this.form.types=this.form.types.join(" / "),this.$refs["form"].validate((e=>{e&&s.Z.bookstoreApi.update(this.form).then((e=>{console.log("修改书店",e),200==e.data.code&&(this.$message.success("修改成功!"),this.$router.push("/home/bookstore-list"))}))}))},initMap(){r().load({key:"7bc653e04678082d08022d65625bad6e",version:"2.0",plugins:["AMap.Geocoder"]}).then((e=>{this.map=new e.Map("container",{viewMode:"3D",zoom:12,center:[113.659404,34.772296]}),this.map.on("click",(o=>{let t=o.lnglat.getLng(),i=o.lnglat.getLat();console.log(`经纬度:[${t},${i}]`);let n=new e.Geocoder;n.getAddress([t,i],((e,o)=>{console.log(e,o);let n=o.regeocode.addressComponent;this.form.address=o.regeocode.formattedAddress,this.form.city=n.city,this.form.province=n.province,this.form.district=n.district,this.form.latitude=i,this.form.longitude=t}))}))}))}},mounted(){console.log(this.form.id),s.Z.bookstoreApi.queryByid({id:this.form.id}).then((e=>{console.log("通过id查询的书店详情是",e),this.form=e.data.data,this.form.types=this.form.types.split("／")})),this.initMap(),s.Z.bookstoreApi.queryTypes().then((e=>{console.log("加载书店类型列表",e),this.types=e.data.data}))}},p=l,d=t(1001),c=(0,d.Z)(p,i,n,!1,null,"7c32be2c",null),u=c.exports},7634:function(e,o,t){t(7658),function(o,t){e.exports=t()}(0,(function(){function e(e){var i=[];return e.AMapUI&&i.push(o(e.AMapUI)),e.Loca&&i.push(t(e.Loca)),Promise.all(i)}function o(e){return new Promise((function(o,t){var s=[];if(e.plugins)for(var l=0;l<e.plugins.length;l+=1)-1==n.AMapUI.plugins.indexOf(e.plugins[l])&&s.push(e.plugins[l]);if(a.AMapUI===i.failed)t("前次请求 AMapUI 失败");else if(a.AMapUI===i.notload){a.AMapUI=i.loading,n.AMapUI.version=e.version||n.AMapUI.version,l=n.AMapUI.version;var p=document.body||document.head,d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/ui/"+l+"/main.js",d.onerror=function(e){a.AMapUI=i.failed,t("请求 AMapUI 失败")},d.onload=function(){if(a.AMapUI=i.loaded,s.length)window.AMapUI.loadUI(s,(function(){for(var e=0,t=s.length;e<t;e++){var i=s[e].split("/").slice(-1)[0];window.AMapUI[i]=arguments[e]}for(o();r.AMapUI.length;)r.AMapUI.splice(0,1)[0]()}));else for(o();r.AMapUI.length;)r.AMapUI.splice(0,1)[0]()},p.appendChild(d)}else a.AMapUI===i.loaded?e.version&&e.version!==n.AMapUI.version?t("不允许多个版本 AMapUI 混用"):s.length?window.AMapUI.loadUI(s,(function(){for(var e=0,t=s.length;e<t;e++){var i=s[e].split("/").slice(-1)[0];window.AMapUI[i]=arguments[e]}o()})):o():e.version&&e.version!==n.AMapUI.version?t("不允许多个版本 AMapUI 混用"):r.AMapUI.push((function(e){e?t(e):s.length?window.AMapUI.loadUI(s,(function(){for(var e=0,t=s.length;e<t;e++){var i=s[e].split("/").slice(-1)[0];window.AMapUI[i]=arguments[e]}o()})):o()}))}))}function t(e){return new Promise((function(o,t){if(a.Loca===i.failed)t("前次请求 Loca 失败");else if(a.Loca===i.notload){a.Loca=i.loading,n.Loca.version=e.version||n.Loca.version;var s=n.Loca.version,l=n.AMap.version.startsWith("2"),p=s.startsWith("2");if(l&&!p||!l&&p)t("JSAPI 与 Loca 版本不对应！！");else{l=n.key,p=document.body||document.head;var d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/loca?v="+s+"&key="+l,d.onerror=function(e){a.Loca=i.failed,t("请求 AMapUI 失败")},d.onload=function(){for(a.Loca=i.loaded,o();r.Loca.length;)r.Loca.splice(0,1)[0]()},p.appendChild(d)}}else a.Loca===i.loaded?e.version&&e.version!==n.Loca.version?t("不允许多个版本 Loca 混用"):o():e.version&&e.version!==n.Loca.version?t("不允许多个版本 Loca 混用"):r.Loca.push((function(e){e?t(e):t()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var i;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(i||(i={}));var n={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},a={AMap:i.notload,AMapUI:i.notload,Loca:i.notload},r={AMap:[],AMapUI:[],Loca:[]},s=[],l=function(e){"function"==typeof e&&(a.AMap===i.loaded?e(window.AMap):s.push(e))};return{load:function(o){return new Promise((function(t,r){if(a.AMap==i.failed)r("");else if(a.AMap==i.notload){var p=o.key,d=o.version,c=o.plugins;p?(window.AMap&&"lbs.amap.com"!==location.host&&r("禁止多种API加载方式混用"),n.key=p,n.AMap.version=d||n.AMap.version,n.AMap.plugins=c||n.AMap.plugins,a.AMap=i.loading,d=document.body||document.head,window.___onAPILoaded=function(n){if(delete window.___onAPILoaded,n)a.AMap=i.failed,r(n);else for(a.AMap=i.loaded,e(o).then((function(){t(window.AMap)}))["catch"](r);s.length;)s.splice(0,1)[0]()},c=document.createElement("script"),c.type="text/javascript",c.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+n.AMap.version+"&key="+p+"&plugin="+n.AMap.plugins.join(","),c.onerror=function(e){a.AMap=i.failed,r(e)},d.appendChild(c)):r("请填写key")}else if(a.AMap==i.loaded)if(o.key&&o.key!==n.key)r("多个不一致的 key");else if(o.version&&o.version!==n.AMap.version)r("不允许多个版本 JSAPI 混用");else{if(p=[],o.plugins)for(d=0;d<o.plugins.length;d+=1)-1==n.AMap.plugins.indexOf(o.plugins[d])&&p.push(o.plugins[d]);p.length?window.AMap.plugin(p,(function(){e(o).then((function(){t(window.AMap)}))["catch"](r)})):e(o).then((function(){t(window.AMap)}))["catch"](r)}else if(o.key&&o.key!==n.key)r("多个不一致的 key");else if(o.version&&o.version!==n.AMap.version)r("不允许多个版本 JSAPI 混用");else{var u=[];if(o.plugins)for(d=0;d<o.plugins.length;d+=1)-1==n.AMap.plugins.indexOf(o.plugins[d])&&u.push(o.plugins[d]);l((function(){u.length?window.AMap.plugin(u,(function(){e(o).then((function(){t(window.AMap)}))["catch"](r)})):e(o).then((function(){t(window.AMap)}))["catch"](r)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,n={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},a={AMap:i.notload,AMapUI:i.notload,Loca:i.notload},r={AMap:[],AMapUI:[],Loca:[]}}}}))}}]);
//# sourceMappingURL=443.8a297a29.js.map